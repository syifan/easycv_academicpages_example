{"version":3,"file":"index.mjs","sources":["../src/renderCv.js"],"sourcesContent":["const CONTACT_ORDER = [\"phone\", \"email\", \"website\"];\n\nconst isNonEmptyString = (value) =>\n  typeof value === \"string\" && value.trim().length > 0;\n\nconst iconLooksLikeFontAwesome = (value) => /\\bfa-[\\w-]+/i.test(value);\n\nconst getIconDescriptor = (iconValue) => {\n  if (isNonEmptyString(iconValue)) {\n    const trimmed = iconValue.trim();\n    if (iconLooksLikeFontAwesome(trimmed)) {\n      return { type: \"fontawesome\", value: trimmed };\n    }\n  }\n  return null;\n};\n\nconst formatWebsite = (value) =>\n  /^https?:\\/\\//i.test(value) ? value : `https://${value}`;\n\nconst normalizeArray = (value) => (Array.isArray(value) ? value : []);\n\nconst isHtmlMetaLine = (metaLine) =>\n  metaLine &&\n  typeof metaLine === \"object\" &&\n  !Array.isArray(metaLine) &&\n  typeof metaLine.html === \"string\";\n\nconst isHtmlValue = (value) =>\n  value &&\n  typeof value === \"object\" &&\n  !Array.isArray(value) &&\n  typeof value.html === \"string\";\n\nconst hasContent = (value) => {\n  if (value === null || value === undefined) {\n    return false;\n  }\n  if (isHtmlValue(value)) {\n    return value.html.trim().length > 0;\n  }\n  if (typeof value === \"boolean\") {\n    return true;\n  }\n  return String(value).trim().length > 0;\n};\n\nconst resolveTrimmedValue = (value) =>\n  isNonEmptyString(value) ? value.trim() : \"\";\n\nconst createContactEntry = (key, rawValue) => {\n  if (isNonEmptyString(rawValue)) {\n    const value = rawValue.trim();\n    return {\n      key,\n      value,\n      displayValue: value,\n      icon: null,\n      href:\n        key === \"email\"\n          ? `mailto:${value}`\n          : key === \"website\"\n          ? formatWebsite(value)\n          : undefined,\n    };\n  }\n\n  if (rawValue && typeof rawValue === \"object\" && !Array.isArray(rawValue)) {\n    const value = resolveTrimmedValue(rawValue.value);\n    if (!value) {\n      return null;\n    }\n\n    const entry = {\n      key,\n      value,\n      displayValue: resolveTrimmedValue(rawValue.display) || value,\n      href: resolveTrimmedValue(rawValue.href) || undefined,\n      icon: isNonEmptyString(rawValue.icon)\n        ? getIconDescriptor(rawValue.icon)\n        : null,\n    };\n\n    if (!entry.href) {\n      if (key === \"email\") {\n        entry.href = `mailto:${value}`;\n      } else if (key === \"website\") {\n        entry.href = formatWebsite(value);\n      }\n    }\n\n    if (typeof rawValue.newTab === \"boolean\") {\n      entry.openInNewTab = rawValue.newTab;\n    }\n\n    if (isNonEmptyString(rawValue.label)) {\n      entry.label = rawValue.label.trim();\n    }\n\n    return entry;\n  }\n\n  return null;\n};\n\nconst buildContactEntries = (contact) => {\n  if (!contact || typeof contact !== \"object\" || Array.isArray(contact)) {\n    return [];\n  }\n\n  const entries = [];\n  const processedKeys = new Set();\n\n  const tryAddEntry = (key) => {\n    if (processedKeys.has(key)) {\n      return;\n    }\n    processedKeys.add(key);\n    const entry = createContactEntry(key, contact[key]);\n    if (entry) {\n      entries.push(entry);\n    }\n  };\n\n  CONTACT_ORDER.forEach(tryAddEntry);\n  Object.keys(contact).forEach((key) => {\n    if (!processedKeys.has(key)) {\n      tryAddEntry(key);\n    }\n  });\n\n  return entries;\n};\n\nconst createElement = (tagName, { className, attrs } = {}) => {\n  const element = document.createElement(tagName);\n  if (className) {\n    element.className = className;\n  }\n  if (attrs) {\n    Object.entries(attrs).forEach(([attr, value]) => {\n      if (value === undefined || value === null) {\n        return;\n      }\n      element.setAttribute(attr, value);\n    });\n  }\n  return element;\n};\n\nconst renderContactIcon = (descriptor) => {\n  if (!descriptor || descriptor.type !== \"fontawesome\") {\n    return null;\n  }\n  const icon = createElement(\"span\", {\n    className: `contact-icon fa-fw ${descriptor.value}`,\n    attrs: { \"aria-hidden\": \"true\" },\n  });\n  return icon;\n};\n\nconst renderContactEntry = (entry) => {\n  const wrapper = createElement(\"div\", {\n    className: \"contact-item\",\n  });\n  const icon = renderContactIcon(entry.icon);\n  if (icon) {\n    wrapper.appendChild(icon);\n  }\n\n  const displayValue = entry.displayValue ?? entry.value ?? \"\";\n  if (entry.href) {\n    const anchor = createElement(\"a\", {\n      attrs: {\n        href: entry.href,\n        target: entry.openInNewTab ? \"_blank\" : undefined,\n        rel: entry.openInNewTab ? \"noreferrer\" : undefined,\n      },\n    });\n    anchor.textContent = displayValue;\n    wrapper.appendChild(anchor);\n  } else {\n    const span = document.createElement(\"span\");\n    span.textContent = displayValue;\n    wrapper.appendChild(span);\n  }\n  return wrapper;\n};\n\nconst renderTagline = (tags) => {\n  if (!Array.isArray(tags) || tags.length === 0) {\n    return null;\n  }\n  const tagline = createElement(\"p\", { className: \"tagline\" });\n  tags.forEach((tag, index) => {\n    const span = document.createElement(\"span\");\n    span.textContent = String(tag);\n    tagline.appendChild(span);\n    if (index < tags.length - 1) {\n      tagline.appendChild(document.createElement(\"br\"));\n    }\n  });\n  return tagline;\n};\n\nconst renderHeader = (header, contactEntries) => {\n  const headerElement = createElement(\"header\", { className: \"cv-header\" });\n  const nameWrapper = document.createElement(\"div\");\n  const heading = document.createElement(\"h1\");\n  heading.textContent = header.name ?? \"\";\n  nameWrapper.appendChild(heading);\n\n  const tagline = renderTagline(Array.isArray(header.tags) ? header.tags : []);\n  if (tagline) {\n    nameWrapper.appendChild(tagline);\n  }\n\n  headerElement.appendChild(nameWrapper);\n\n  if (contactEntries.length > 0) {\n    const contact = createElement(\"div\", { className: \"contact\" });\n    contactEntries.forEach((entry) =>\n      contact.appendChild(renderContactEntry(entry))\n    );\n    headerElement.appendChild(contact);\n  }\n\n  return headerElement;\n};\n\nconst renderMetaLine = (metaLine) => {\n  if (metaLine == null) {\n    return null;\n  }\n\n  if (isHtmlMetaLine(metaLine)) {\n    const paragraph = createElement(\"p\", { className: \"list-heading\" });\n    paragraph.innerHTML = metaLine.html;\n    return paragraph;\n  }\n\n  const paragraph = createElement(\"p\", { className: \"list-heading\" });\n  paragraph.textContent = String(metaLine);\n  return paragraph;\n};\n\nconst renderValueNode = (value, { strong = false } = {}) => {\n  if (!hasContent(value)) {\n    return null;\n  }\n\n  if (isHtmlValue(value)) {\n    const span = document.createElement(\"span\");\n    span.innerHTML = value.html;\n    return span;\n  }\n\n  const text = document.createTextNode(String(value));\n  if (!strong) {\n    const span = document.createElement(\"span\");\n    span.appendChild(text);\n    return span;\n  }\n\n  const strongEl = document.createElement(\"strong\");\n  strongEl.appendChild(text);\n  return strongEl;\n};\n\nconst renderTableEntry = (entry, condensed) => {\n  const content = normalizeArray(entry?.content ?? []);\n  const meta = normalizeArray(entry?.meta ?? []);\n  const hasIndexColumn = hasContent(entry?.index);\n  const hasMetaColumn = meta.some(hasContent);\n  const rowCount = Math.max(\n    content.length,\n    hasMetaColumn ? meta.length : 0,\n    hasIndexColumn ? 1 : 0\n  );\n\n  if (rowCount === 0) {\n    return null;\n  }\n\n  const fragment = document.createDocumentFragment();\n  for (let rowIndex = 0; rowIndex < rowCount; rowIndex += 1) {\n    const tr = document.createElement(\"tr\");\n    const rowClassNames = [];\n    if (rowIndex === 0) {\n      rowClassNames.push(\"entry-start\");\n    }\n    if (condensed) {\n      rowClassNames.push(\"condensed-row\");\n    }\n    tr.className = rowClassNames.filter(Boolean).join(\" \");\n\n    if (hasIndexColumn) {\n      const td = createElement(\"td\", { className: \"hanging-cell\" });\n      if (rowIndex === 0) {\n        const valueNode = renderValueNode(entry.index);\n        if (valueNode) {\n          td.appendChild(valueNode);\n        }\n      }\n      tr.appendChild(td);\n    }\n\n    if (hasMetaColumn) {\n      const td = createElement(\"td\", { className: \"right-cell\" });\n      const metaValue = meta[rowIndex];\n      if (hasContent(metaValue)) {\n        const valueNode = renderValueNode(metaValue);\n        if (valueNode) {\n          td.appendChild(valueNode);\n        }\n      }\n      tr.appendChild(td);\n    }\n\n    if (condensed) {\n      if (rowIndex === 0) {\n        const td = createElement(\"td\", { className: \"left-cell\" });\n        td.setAttribute(\"rowspan\", String(rowCount));\n        content.forEach((value, contentIndex) => {\n          if (!hasContent(value)) {\n            return;\n          }\n          const span = createElement(\"span\", {\n            className:\n              contentIndex === 0 ? \"left-header-span\" : \"left-entry-span\",\n          });\n          const valueNode = renderValueNode(value, {\n            strong: contentIndex === 0,\n          });\n          if (valueNode) {\n            span.appendChild(valueNode);\n            td.appendChild(span);\n          }\n        });\n        tr.appendChild(td);\n      }\n    } else {\n      const contentValue = content[rowIndex];\n      const td = document.createElement(\"td\");\n      if (rowIndex === 0 && hasContent(contentValue)) {\n        td.className = \"left-header\";\n      }\n      const valueNode = renderValueNode(contentValue, {\n        strong: rowIndex === 0,\n      });\n      if (valueNode) {\n        td.appendChild(valueNode);\n      }\n      tr.appendChild(td);\n    }\n\n    fragment.appendChild(tr);\n  }\n\n  return fragment;\n};\n\nconst renderTable = (entries, condensed) => {\n  const table = createElement(\"table\", { className: \"cv-table\" });\n  const tbody = document.createElement(\"tbody\");\n\n  entries.forEach((entry) => {\n    const rowFragment = renderTableEntry(entry, condensed);\n    if (rowFragment) {\n      tbody.appendChild(rowFragment);\n    }\n  });\n\n  table.appendChild(tbody);\n  return table;\n};\n\nconst renderSubsection = (subsection) => {\n  const wrapper = createElement(\"div\", { className: \"subsection\" });\n  if (subsection.id) {\n    wrapper.id = subsection.id;\n  }\n\n  const heading = document.createElement(\"h3\");\n  heading.textContent = subsection.title ?? \"\";\n  wrapper.appendChild(heading);\n\n  const metaLines = normalizeArray(subsection.meta);\n  metaLines.forEach((metaLine) => {\n    const metaNode = renderMetaLine(metaLine);\n    if (metaNode) {\n      wrapper.appendChild(metaNode);\n    }\n  });\n\n  const entries = normalizeArray(subsection.entries);\n  if (entries.length > 0) {\n    wrapper.appendChild(renderTable(entries, Boolean(subsection.condensed)));\n  }\n\n  return wrapper;\n};\n\nconst renderSection = (section) => {\n  if (!section) {\n    return null;\n  }\n  const sectionElement = createElement(\"section\", {\n    className: \"cv-section\",\n    attrs: {\n      id: section.id || undefined,\n      \"aria-label\": section.title || undefined,\n    },\n  });\n\n  const header = createElement(\"header\", { className: \"section-header\" });\n  const heading = document.createElement(\"h2\");\n  heading.textContent = section.title ?? \"\";\n  header.appendChild(heading);\n  sectionElement.appendChild(header);\n\n  const metaLines = normalizeArray(section.meta);\n  metaLines.forEach((metaLine) => {\n    const metaNode = renderMetaLine(metaLine);\n    if (metaNode) {\n      sectionElement.appendChild(metaNode);\n    }\n  });\n\n  const entries = normalizeArray(section.entries);\n  if (entries.length > 0) {\n    sectionElement.appendChild(\n      renderTable(entries, Boolean(section.condensed))\n    );\n  }\n\n  const subsections = normalizeArray(section.subsections);\n  subsections.forEach((subsection) => {\n    const subsectionNode = renderSubsection(subsection);\n    sectionElement.appendChild(subsectionNode);\n  });\n\n  return sectionElement;\n};\n\nconst createAttribution = () => {\n  const footer = createElement(\"footer\", { className: \"template-attribution\" });\n  footer.innerHTML =\n    'CV template provided by <a href=\"https://sarchlab.org/syifan\" target=\"_blank\" rel=\"noreferrer\">Yifan Sun</a>. Template can be found at <a href=\"https://github.com/syifan/easycv\" target=\"_blank\" rel=\"noreferrer\">https://github.com/syifan/easycv</a>.';\n  return footer;\n};\n\nlet printInstanceCounter = 0;\nconst createPrintId = () => {\n  printInstanceCounter += 1;\n  return `easycv-${Date.now().toString(36)}-${printInstanceCounter.toString(\n    36\n  )}`;\n};\n\nconst createFloatingActions = (printTargetId) => {\n  const actions = createElement(\"div\", {\n    className: \"floating-actions\",\n    attrs: { \"aria-label\": \"page controls\" },\n  });\n\n  const topButton = createElement(\"button\", {\n    className: \"action-button\",\n    attrs: { type: \"button\" },\n  });\n  topButton.textContent = \"Back to Top\";\n  topButton.addEventListener(\"click\", () => {\n    if (\n      typeof window !== \"undefined\" &&\n      typeof window.scrollTo === \"function\"\n    ) {\n      window.scrollTo({ top: 0, behavior: \"smooth\" });\n    }\n  });\n\n  const downloadButton = createElement(\"button\", {\n    className: \"action-button\",\n    attrs: { type: \"button\" },\n  });\n  downloadButton.textContent = \"Download PDF\";\n  downloadButton.addEventListener(\"click\", () => {\n    if (typeof window === \"undefined\" || typeof document === \"undefined\") {\n      return;\n    }\n\n    const body = document.body;\n    const enableCvOnlyPrint = () => {\n      body.classList.add(\"easycv-print-cv-only\");\n      if (printTargetId) {\n        body.setAttribute(\"data-easycv-print-id\", printTargetId);\n      }\n    };\n\n    const disableCvOnlyPrint = () => {\n      body.classList.remove(\"easycv-print-cv-only\");\n      if (\n        printTargetId &&\n        body.getAttribute(\"data-easycv-print-id\") === printTargetId\n      ) {\n        body.removeAttribute(\"data-easycv-print-id\");\n      }\n    };\n\n    enableCvOnlyPrint();\n\n    const mediaQuery = window.matchMedia ? window.matchMedia(\"print\") : null;\n    const handleChange = (event) => {\n      if (!event.matches) {\n        disableCvOnlyPrint();\n      }\n    };\n\n    if (mediaQuery) {\n      if (mediaQuery.addEventListener) {\n        mediaQuery.addEventListener(\"change\", handleChange);\n      } else if (mediaQuery.addListener) {\n        mediaQuery.addListener(handleChange);\n      }\n    }\n\n    if (typeof window.print === \"function\") {\n      window.print();\n    }\n\n    setTimeout(disableCvOnlyPrint, 1500);\n  });\n\n  actions.appendChild(topButton);\n  actions.appendChild(downloadButton);\n  return actions;\n};\n\nconst createCvDom = (data, { includeActions = true } = {}) => {\n  const container = createElement(\"div\", { className: \"cv-container\" });\n  const page = createElement(\"div\", { className: \"cv-page\" });\n  const printId = createPrintId();\n  container.dataset.easycvPrintId = printId;\n  const headerData = data?.header ?? { name: \"\" };\n  const sections = normalizeArray(data?.sections);\n  const contactEntries = buildContactEntries(headerData.contact);\n\n  page.appendChild(renderHeader(headerData, contactEntries));\n\n  const main = document.createElement(\"main\");\n  sections.forEach((section) => {\n    const sectionNode = renderSection(section);\n    if (sectionNode) {\n      main.appendChild(sectionNode);\n    }\n  });\n  page.appendChild(main);\n\n  container.appendChild(page);\n  container.appendChild(createAttribution());\n\n  if (includeActions) {\n    container.appendChild(createFloatingActions(printId));\n  }\n\n  return {\n    element: container,\n    headerName: resolveTrimmedValue(headerData?.name),\n  };\n};\n\nconst resolveContainer = (target) => {\n  if (typeof document === \"undefined\") {\n    throw new Error(\"renderCv requires a DOM-like environment\");\n  }\n\n  if (typeof target === \"string\") {\n    const element = document.querySelector(target);\n    if (!element) {\n      throw new Error(`No element matches selector: ${target}`);\n    }\n    return element;\n  }\n\n  if (target && typeof target.appendChild === \"function\") {\n    return target;\n  }\n\n  throw new TypeError(\"renderCv expects a DOM element or selector string\");\n};\n\nconst updateDocumentTitle = (name, template = \"%s - Curriculum Vitae\") => {\n  if (!name || typeof document === \"undefined\") {\n    return;\n  }\n\n  if (template && template.includes(\"%s\")) {\n    document.title = template.replace(\"%s\", name);\n    return;\n  }\n\n  if (template) {\n    document.title = template;\n    return;\n  }\n\n  document.title = name;\n};\n\nexport const createCvElement = (data, options = {}) =>\n  createCvDom(data, { includeActions: options.actions !== false }).element;\n\nexport const renderCv = (target, data, options = {}) => {\n  const container = resolveContainer(target);\n  const { element, headerName } = createCvDom(data, {\n    includeActions: options.actions !== false,\n  });\n\n  container.innerHTML = \"\";\n  container.appendChild(element);\n\n  if (options.setDocumentTitle !== false) {\n    updateDocumentTitle(headerName, options.titleTemplate);\n  }\n\n  return element;\n};\n"],"names":["CONTACT_ORDER","isNonEmptyString","value","iconLooksLikeFontAwesome","getIconDescriptor","iconValue","trimmed","formatWebsite","normalizeArray","isHtmlMetaLine","metaLine","isHtmlValue","hasContent","resolveTrimmedValue","createContactEntry","key","rawValue","entry","buildContactEntries","contact","entries","processedKeys","tryAddEntry","createElement","tagName","className","attrs","element","attr","renderContactIcon","descriptor","renderContactEntry","wrapper","icon","displayValue","anchor","span","renderTagline","tags","tagline","tag","index","renderHeader","header","contactEntries","headerElement","nameWrapper","heading","renderMetaLine","paragraph","renderValueNode","strong","text","strongEl","renderTableEntry","condensed","content","meta","hasIndexColumn","hasMetaColumn","rowCount","fragment","rowIndex","tr","rowClassNames","td","valueNode","metaValue","contentIndex","contentValue","renderTable","table","tbody","rowFragment","renderSubsection","subsection","metaNode","renderSection","section","sectionElement","subsectionNode","createAttribution","footer","printInstanceCounter","createPrintId","createFloatingActions","printTargetId","actions","topButton","downloadButton","body","enableCvOnlyPrint","disableCvOnlyPrint","mediaQuery","handleChange","event","createCvDom","data","includeActions","container","page","printId","headerData","sections","main","sectionNode","resolveContainer","target","updateDocumentTitle","name","template","createCvElement","options","renderCv","headerName"],"mappings":"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"}